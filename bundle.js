(()=>{"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function l(t){return"function"==typeof t}function r(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function a(t){return 0===Object.keys(t).length}new Set;let c=!1;const s=new Set;function i(t,e){c&&s.delete(e),e.parentNode!==t&&t.appendChild(e)}function u(t,e,n){c&&s.delete(e),(e.parentNode!==t||n&&e.nextSibling!==n)&&t.insertBefore(e,n||null)}function f(t){c?s.add(t):t.parentNode&&t.parentNode.removeChild(t)}function h(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function d(t){return document.createElement(t)}function g(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function p(t){return document.createTextNode(t)}function $(){return p(" ")}function m(){return p("")}function w(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function x(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function v(t){return""===t?null:+t}function y(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function B(t,e){t.value=null==e?"":e}function R(t,e){for(let n=0;n<t.options.length;n+=1){const o=t.options[n];if(o.__value===e)return void(o.selected=!0)}}let b;function C(t){b=t}function G(){if(!b)throw new Error("Function called outside component initialization");return b}function k(t){G().$$.on_mount.push(t)}function M(){const t=G();return(e,n)=>{const o=t.$$.callbacks[e];if(o){const l=function(t,e){const n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);o.slice().forEach((e=>{e.call(t,l)}))}}}new Set;const _=[],z=[],S=[],D=[],E=Promise.resolve();let I=!1;function Y(t){S.push(t)}let T=!1;const N=new Set;function Q(){if(!T){T=!0;do{for(let t=0;t<_.length;t+=1){const e=_[t];C(e),A(e.$$)}for(C(null),_.length=0;z.length;)z.pop()();for(let t=0;t<S.length;t+=1){const e=S[t];N.has(e)||(N.add(e),e())}S.length=0}while(_.length);for(;D.length;)D.pop()();I=!1,T=!1,N.clear()}}function A(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Y)}}const P=new Set;let q,L;function F(t,e){t&&t.i&&(P.delete(t),t.i(e))}function j(t,e,n,o){if(t&&t.o){if(P.has(t))return;P.add(t),q.c.push((()=>{P.delete(t),o&&(n&&t.d(1),o())})),t.o(e)}}function O(t){t&&t.c()}function H(t,n,r,a){const{fragment:c,on_mount:s,on_destroy:i,after_update:u}=t.$$;c&&c.m(n,r),a||Y((()=>{const n=s.map(e).filter(l);i?i.push(...n):o(n),t.$$.on_mount=[]})),u.forEach(Y)}function U(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Z(e,l,r,a,i,u,h=[-1]){const d=b;C(e);const g=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:i,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:l.context||[]),callbacks:n(),dirty:h,skip_bound:!1};let p=!1;if(g.ctx=r?r(e,l.props||{},((t,n,...o)=>{const l=o.length?o[0]:n;return g.ctx&&i(g.ctx[t],g.ctx[t]=l)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](l),p&&function(t,e){-1===t.$$.dirty[0]&&(_.push(t),I||(I=!0,E.then(Q)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(e,t)),n})):[],g.update(),p=!0,o(g.before_update),g.fragment=!!a&&a(g.ctx),l.target){if(l.hydrate){c=!0;const t=($=l.target,Array.from($.childNodes));g.fragment&&g.fragment.l(t),t.forEach(f)}else g.fragment&&g.fragment.c();l.intro&&F(e.$$.fragment),H(e,l.target,l.anchor,l.customElement),function(){c=!1;for(const t of s)t.parentNode.removeChild(t);s.clear()}(),Q()}var $;C(d)}"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global,new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"]),"function"==typeof HTMLElement&&(L=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:t}=this.$$;this.$$.on_disconnect=t.map(e).filter(l);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,e,n){this[t]=n}disconnectedCallback(){o(this.$$.on_disconnect)}$destroy(){U(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!a(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}});class J{$destroy(){U(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&!a(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function W(e){let n,o,l,r;return{c(){n=d("div"),o=d("input"),x(o,"type","file")},m(t,a){u(t,n,a),i(n,o),l||(r=w(o,"change",e[1]),l=!0)},p:t,i:t,o:t,d(t){t&&f(n),l=!1,r()}}}function X(t,e,n){const o=M();let l;return t.$$.update=()=>{1&t.$$.dirty&&l&&function(t){const e=new FileReader;e.onload=t=>{o("load",new Uint8Array(t.target.result))},e.readAsArrayBuffer(t)}(l[0])},[l,function(){l=this.files,n(0,l)}]}const K=class extends J{constructor(t){super(),Z(this,t,X,W,r,{})}};function V(t){let e,n;return{c(){e=d("h2"),n=p(t[0]),x(e,"class","svelte-6teu96")},m(t,o){u(t,e,o),i(e,n)},p(t,e){1&e&&y(n,t[0])},d(t){t&&f(e)}}}function tt(e){let n,o,l,r,a,c=e[0]&&V(e);return{c(){n=d("div"),c&&c.c(),o=$(),l=d("canvas")},m(t,s){u(t,n,s),c&&c.m(n,null),i(n,o),i(n,l),e[5](l),r||(a=w(l,"mouseup",e[2]),r=!0)},p(t,[e]){t[0]?c?c.p(t,e):(c=V(t),c.c(),c.m(n,o)):c&&(c.d(1),c=null)},i:t,o:t,d(t){t&&f(n),c&&c.d(),e[5](null),r=!1,a()}}}function et(t,e,n){let{data:o}=e,{title:l=null}=e,{position:r=null}=e;const a=M();let c,s;function i(t,e){t&&c&&s&&(n(1,c.width=t.width,c),n(1,c.height=t.height,c),s.clearRect(0,0,t.width,t.height),s.putImageData(t,0,0),e&&(s.strokeStyle="blue",s.lineWidth=1,s.beginPath(),s.rect(8*e.x,8*e.y,8,8),s.closePath(),s.stroke()))}return k((()=>{s=c.getContext("2d"),i(o,r)})),t.$$set=t=>{"data"in t&&n(3,o=t.data),"title"in t&&n(0,l=t.title),"position"in t&&n(4,r=t.position)},t.$$.update=()=>{24&t.$$.dirty&&i(o,r)},[l,c,function(t){const e=t.target.getBoundingClientRect(),n=Math.floor((t.clientX-e.left)/8),o=Math.floor((t.clientY-e.top)/8);a("select",{x:n,y:o})},o,r,function(t){z[t?"unshift":"push"]((()=>{c=t,n(1,c)}))}]}const nt=class extends J{constructor(t){super(),Z(this,t,et,tt,r,{data:3,title:0,position:4})}};function ot(t){let e,n,o,l,r,a,c,s=t[0].RGB.width+"",h=t[0].RGB.height+"",g=t[0].RGB.width*t[0].RGB.height*3+"";return{c(){e=d("span"),n=p(s),o=p("x"),l=p(h),r=p(" RGB ("),a=p(g),c=p(" bytes)")},m(t,s){u(t,e,s),i(e,n),i(e,o),i(e,l),i(e,r),i(e,a),i(e,c)},p(t,e){1&e&&s!==(s=t[0].RGB.width+"")&&y(n,s),1&e&&h!==(h=t[0].RGB.height+"")&&y(l,h),1&e&&g!==(g=t[0].RGB.width*t[0].RGB.height*3+"")&&y(a,g)},d(t){t&&f(e)}}}function lt(t){let e,n,o,l,r,a,c,s,h;l=new K({}),l.$on("load",t[2]),a=new nt({props:{data:t[0].RGB}});let g=t[0].RGB&&ot(t);return{c(){e=d("div"),n=d("h2"),n.textContent="Select Demo Image",o=$(),O(l.$$.fragment),r=$(),O(a.$$.fragment),c=$(),s=d("div"),g&&g.c()},m(t,f){u(t,e,f),i(e,n),i(e,o),H(l,e,null),i(e,r),H(a,e,null),i(e,c),i(e,s),g&&g.m(s,null),h=!0},p(t,[e]){const n={};1&e&&(n.data=t[0].RGB),a.$set(n),t[0].RGB?g?g.p(t,e):(g=ot(t),g.c(),g.m(s,null)):g&&(g.d(1),g=null)},i(t){h||(F(l.$$.fragment,t),F(a.$$.fragment,t),h=!0)},o(t){j(l.$$.fragment,t),j(a.$$.fragment,t),h=!1},d(t){t&&f(e),U(l),U(a),g&&g.d()}}}function rt(t,e,n){let{context:o}=e;function l(t){const e=new Image,l=new FileReader;l.readAsDataURL(new Blob([t])),l.onload=t=>{e.onload=()=>function(t){const e=Math.max(t.width,t.height),l=Math.floor(300*t.width/e),r=Math.floor(300*t.height/e),a=document.createElement("canvas");a.width=l,a.height=r;const c=a.getContext("2d");c.drawImage(t,0,0,t.width,t.height,0,0,l,r);const s=c.getImageData(0,0,l,r);n(0,o.RGB=s,o)}(e),e.src=t.target.result}}return k((()=>{o.RGB||fetch("Florence-Colgate.jpg").then((t=>t.arrayBuffer())).then((t=>l(new Uint8Array(t))))})),t.$$set=t=>{"context"in t&&n(0,o=t.context)},[o,l,t=>l(t.detail)]}const at=class extends J{constructor(t){super(),Z(this,t,rt,lt,r,{context:0})}};function ct(t,e,n){t.data[e]=255&n.R,t.data[e+1]=255&n.G,t.data[e+2]=255&n.B,t.data[e+3]=255}function st(t){return t<0?0:t>255?255:Math.floor(t)}function it(t){return t<1?1:t>255?255:Math.floor(t)}function ut(t,e,n){return{R:st(t+1.402*(n-128)),G:st(t-.344136*(e-128)-.714136*(n-128)),B:st(t+1.772*(e-128))}}function ft(t,e,n,o,l){const r=Math.floor((e+o-1)/o),a=Math.floor((n+l-1)/l),c=[];for(let n=0;n<a;++n)for(let s=0;s<r;++s){let i=t[s*o+n*l*e],u=1;2==o&&s+1<r&&(i+=t[s*o+1+n*l*e],u*=2),2==l&&n+1<a&&(i+=t[s*o+(n*l+1)*e],s+1<r&&(i+=t[s*o+1+(n*l+1)*e]),u*=2),c.push(Math.floor(i/u))}return c}function ht(t,e,n){const o=[];for(let l=0;l<8;++l){const r=[];o.push(r);for(let o=0;o<8;++o){const a=8*e+o,c=8*n+l;a<t.RGB.width&&c<t.RGB.height?r.push(t.Yp[c*t.RGB.width+a]):r.push(0)}}return o}function dt(t){const e=[];for(let n=0;n<8;n++){const o=[];e.push(o);for(let e=0;e<8;e++){let l=.25;0==n&&(l*=Math.SQRT1_2),0==e&&(l*=Math.SQRT1_2);let r=0;for(let o=0;o<8;o++)for(let l=0;l<8;l++)r+=(t[o][l]-128)*Math.cos((2*l+1)*e*Math.PI/16)*Math.cos((2*o+1)*n*Math.PI/16);o.push(Math.round(l*r))}}return e}function gt(t){const e=[];for(let n=0;n<8;n++){const o=[];e.push(o);for(let e=0;e<8;e++){let l=0;for(let o=0;o<8;o++)for(let r=0;r<8;r++){let a=1;0==o&&(a*=Math.SQRT1_2),0==r&&(a*=Math.SQRT1_2),l+=a*t[o][r]*Math.cos((2*e+1)*r*Math.PI/16)*Math.cos((2*n+1)*o*Math.PI/16)}o.push(st(Math.trunc(128+l/4)))}}return e}const pt=[[16,11,10,16,24,40,51,61],[12,12,14,19,26,58,60,55],[14,13,16,24,40,57,69,56],[14,17,22,29,51,87,80,62],[18,22,37,56,68,109,103,77],[24,35,55,64,81,104,113,92],[49,64,78,87,103,121,120,101],[72,92,95,98,112,100,103,199]];function $t(t,e){const n=[];for(let o=0;o<8;o++){const l=[];n.push(l);for(let n=0;n<8;n++)l.push(Math.round(t[o][n]/e[o][n]))}return n}function mt(t,e){const n=[];for(let o=0;o<8;o++){const l=[];n.push(l);for(let n=0;n<8;n++)l.push(t[o][n]*e[o][n])}return n}const wt=[0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63];function xt(t){let e,n,o,l,r,a,c,s,h,g,p,m,w,v;return r=new nt({props:{title:"RGB",data:t[0].RGB}}),h=new nt({props:{title:"Y'",data:t[1]}}),p=new nt({props:{title:"Cb",data:t[2]}}),w=new nt({props:{title:"Cr",data:t[3]}}),{c(){e=d("div"),n=d("h2"),n.textContent="Color Space Transformation",o=$(),l=d("div"),O(r.$$.fragment),a=$(),c=d("span"),c.textContent="→",s=$(),O(h.$$.fragment),g=$(),O(p.$$.fragment),m=$(),O(w.$$.fragment),x(c,"class","svelte-14qsmix"),x(l,"class","container svelte-14qsmix")},m(t,f){u(t,e,f),i(e,n),i(e,o),i(e,l),H(r,l,null),i(l,a),i(l,c),i(l,s),H(h,l,null),i(l,g),H(p,l,null),i(l,m),H(w,l,null),v=!0},p(t,[e]){const n={};1&e&&(n.data=t[0].RGB),r.$set(n);const o={};2&e&&(o.data=t[1]),h.$set(o);const l={};4&e&&(l.data=t[2]),p.$set(l);const a={};8&e&&(a.data=t[3]),w.$set(a)},i(t){v||(F(r.$$.fragment,t),F(h.$$.fragment,t),F(p.$$.fragment,t),F(w.$$.fragment,t),v=!0)},o(t){j(r.$$.fragment,t),j(h.$$.fragment,t),j(p.$$.fragment,t),j(w.$$.fragment,t),v=!1},d(t){t&&f(e),U(r),U(h),U(p),U(w)}}}function vt(t,e,n){let o,l,r,{context:a}=e;return t.$$set=t=>{"context"in t&&n(0,a=t.context)},t.$$.update=()=>{1&t.$$.dirty&&a&&function(t){n(1,o=new ImageData(t.RGB.width,t.RGB.height)),n(3,r=new ImageData(t.RGB.width,t.RGB.height)),n(2,l=new ImageData(t.RGB.width,t.RGB.height)),t.Yp=[],t.Cr=[],t.Cb=[];for(let n=0;n<t.RGB.data.length;n+=4){const s=(e=t.RGB.data[n],a=t.RGB.data[n+1],c=t.RGB.data[n+2],{Yp:Math.floor(.299*e+.587*a+.114*c),Cb:Math.floor(128-.168736*e-.331264*a+.5*c),Cr:Math.floor(128+.5*e-.418688*a-.081312*c)});t.Yp.push(s.Yp),t.Cb.push(s.Cb),t.Cr.push(s.Cr),ct(o,n,ut(s.Yp,128,128)),ct(l,n,ut(128,s.Cb,128)),ct(r,n,ut(128,128,s.Cr))}var e,a,c}(a)},[a,o,l,r]}const yt=class extends J{constructor(t){super(),Z(this,t,vt,xt,r,{context:0})}};function Bt(t){let e,n,o,l,r,a,c,s,h,g,m,v,B,b,C,G,k,M,_,z,S,D,E,I,T,N,Q,A,P,q,L,Z,J,W,X,K,V,tt,et,ot,lt,rt,at,ct=t[6]/t[7]+"",st=100*t[8]+"";return r=new nt({props:{title:"Y'",data:t[1]}}),c=new nt({props:{title:"Cb",data:t[3]}}),h=new nt({props:{title:"Cr",data:t[2]}}),B=new nt({props:{title:"Result",data:t[4]}}),C=new nt({props:{title:"Error",data:t[5]}}),{c(){e=d("div"),n=d("h2"),n.textContent="Chrominance SubSampling",o=$(),l=d("div"),O(r.$$.fragment),a=$(),O(c.$$.fragment),s=$(),O(h.$$.fragment),g=$(),m=d("span"),m.textContent="→",v=$(),O(B.$$.fragment),b=$(),O(C.$$.fragment),G=$(),k=d("div"),M=d("span"),_=p("Subsampling: "),z=d("select"),S=d("option"),S.textContent="4:4:4",D=d("option"),D.textContent="4:2:2",E=d("option"),E.textContent="4:2:0",I=$(),T=d("ul"),N=d("li"),Q=d("span"),A=p("ratio: "),P=p(ct),q=p(" ("),L=p(t[6]),Z=p(" / "),J=p(t[7]),W=p(")"),X=$(),K=d("li"),V=d("span"),tt=p("error: "),et=p(st),ot=p("%"),x(m,"class","arrow svelte-i8w882"),x(l,"class","container svelte-i8w882"),S.__value="444",S.value=S.__value,D.__value="422",D.value=D.__value,E.__value="420",E.value=E.__value,void 0===t[0]&&Y((()=>t[10].call(z)))},m(f,d){u(f,e,d),i(e,n),i(e,o),i(e,l),H(r,l,null),i(l,a),H(c,l,null),i(l,s),H(h,l,null),i(l,g),i(l,m),i(l,v),H(B,l,null),i(l,b),H(C,l,null),i(e,G),i(e,k),i(k,M),i(M,_),i(M,z),i(z,S),i(z,D),i(z,E),R(z,t[0]),i(e,I),i(e,T),i(T,N),i(N,Q),i(Q,A),i(Q,P),i(Q,q),i(Q,L),i(Q,Z),i(Q,J),i(Q,W),i(T,X),i(T,K),i(K,V),i(V,tt),i(V,et),i(V,ot),lt=!0,rt||(at=w(z,"change",t[10]),rt=!0)},p(t,[e]){const n={};2&e&&(n.data=t[1]),r.$set(n);const o={};8&e&&(o.data=t[3]),c.$set(o);const l={};4&e&&(l.data=t[2]),h.$set(l);const a={};16&e&&(a.data=t[4]),B.$set(a);const s={};32&e&&(s.data=t[5]),C.$set(s),1&e&&R(z,t[0]),(!lt||192&e)&&ct!==(ct=t[6]/t[7]+"")&&y(P,ct),(!lt||64&e)&&y(L,t[6]),(!lt||128&e)&&y(J,t[7]),(!lt||256&e)&&st!==(st=100*t[8]+"")&&y(et,st)},i(t){lt||(F(r.$$.fragment,t),F(c.$$.fragment,t),F(h.$$.fragment,t),F(B.$$.fragment,t),F(C.$$.fragment,t),lt=!0)},o(t){j(r.$$.fragment,t),j(c.$$.fragment,t),j(h.$$.fragment,t),j(B.$$.fragment,t),j(C.$$.fragment,t),lt=!1},d(t){t&&f(e),U(r),U(c),U(h),U(B),U(C),rt=!1,at()}}}function Rt(t,e,n){let o,l,r,a,c,{context:s}=e,i="422",u=1,f=1,h=0;return t.$$set=t=>{"context"in t&&n(9,s=t.context)},t.$$.update=()=>{1&t.$$.dirty&&function(t){if(s){const i="444"===t?1:2,d="420"===t?2:1;n(4,a=new ImageData(s.RGB.width,s.RGB.height)),n(5,c=new ImageData(s.RGB.width,s.RGB.height)),n(1,o=new ImageData(s.RGB.width,s.RGB.height));const g=Math.floor((s.RGB.width+i-1)/i),p=Math.floor((s.RGB.height+d-1)/d);n(2,l=new ImageData(g,p)),n(3,r=new ImageData(g,p)),n(9,s.nCb=ft(s.Cb,s.RGB.width,s.RGB.height,i,d),s),n(9,s.nCr=ft(s.Cr,s.RGB.width,s.RGB.height,i,d),s);for(let t=0;t<s.nCr.length;t+=1)ct(r,4*t,ut(128,s.nCb[t],128)),ct(l,4*t,ut(128,128,s.nCr[t]));function e(t,e,n){return Math.sqrt((e[t]-n[t])*(e[t]-n[t])+(e[t+1]-n[t+1])*(e[t+1]-n[t+1])+(e[t+2]-n[t+2])*(e[t+2]-n[t+2]))}n(8,h=0);for(let t=0,l=0;t<a.data.length;t+=4,l++){ct(o,t,ut(s.Yp[l],128,128));const r=Math.floor(Math.floor(l/s.RGB.width)/d),u=Math.floor(l%s.RGB.width/i);ct(a,t,ut(s.Yp[l],s.nCb[u+r*g],s.nCr[u+r*g]));const f=e(t,s.RGB.data,a.data);ct(c,t,ut(10*f,128,128)),n(8,h+=f/(1+s.RGB.data[t+0])+f/(1+s.RGB.data[t+1])+f/(1+s.RGB.data[t+2]))}n(8,h/=3*a.data.length/4),n(6,u=s.RGB.width*s.RGB.height*3),n(7,f=s.RGB.width*s.RGB.height+g*p*2)}}(i)},[i,o,l,r,a,c,u,f,h,s,function(){i=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),n(0,i)}]}const bt=class extends J{constructor(t){super(),Z(this,t,Rt,Bt,r,{context:9})}};function Ct(t,e,n){const o=t.slice();return o[5]=e[n],o[7]=n,o}function Gt(t,e,n){const o=t.slice();return o[8]=e[n],o[10]=n,o}function kt(t,e,n){const o=t.slice();return o[11]=e[n],o[13]=n,o}function Mt(t,e,n){const o=t.slice();return o[11]=e[n],o[13]=n,o}function _t(t,e,n){const o=t.slice();return o[5]=e[n],o[7]=n,o}function zt(t,e,n){const o=t.slice();return o[8]=e[n],o[10]=n,o}function St(t){let e,n;return{c(){e=d("h2"),n=p(t[2]),x(e,"class","svelte-6teu96")},m(t,o){u(t,e,o),i(e,n)},p(t,e){4&e&&y(n,t[2])},d(t){t&&f(e)}}}function Dt(t){let e,n=t[3],o=[];for(let e=0;e<n.length;e+=1)o[e]=It(_t(t,n,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=m()},m(t,n){for(let e=0;e<o.length;e+=1)o[e].m(t,n);u(t,e,n)},p(t,l){if(8&l){let r;for(n=t[3],r=0;r<n.length;r+=1){const a=_t(t,n,r);o[r]?o[r].p(a,l):(o[r]=It(a),o[r].c(),o[r].m(e.parentNode,e))}for(;r<o.length;r+=1)o[r].d(1);o.length=n.length}},d(t){h(o,t),t&&f(e)}}}function Et(t){let e,n,o,l;return{c(){e=g("rect"),x(e,"x",n=t[10]*qt),x(e,"y",o=t[7]*qt),x(e,"width",qt),x(e,"height",qt),x(e,"fill",l=`rgb(${t[8]}, ${t[8]}, ${t[8]})`)},m(t,n){u(t,e,n)},p(t,n){8&n&&l!==(l=`rgb(${t[8]}, ${t[8]}, ${t[8]})`)&&x(e,"fill",l)},d(t){t&&f(e)}}}function It(t){let e,n=t[5],o=[];for(let e=0;e<n.length;e+=1)o[e]=Et(zt(t,n,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=m()},m(t,n){for(let e=0;e<o.length;e+=1)o[e].m(t,n);u(t,e,n)},p(t,l){if(8&l){let r;for(n=t[5],r=0;r<n.length;r+=1){const a=zt(t,n,r);o[r]?o[r].p(a,l):(o[r]=Et(a),o[r].c(),o[r].m(e.parentNode,e))}for(;r<o.length;r+=1)o[r].d(1);o.length=n.length}},d(t){h(o,t),t&&f(e)}}}function Yt(e){let n,o,l,r,a,c,s,i;return{c(){n=g("line"),a=g("line"),x(n,"x1","0"),x(n,"y1",o=e[13]*qt),x(n,"x2",l=8*qt),x(n,"y2",r=e[13]*qt),x(n,"stroke","black"),x(n,"stroke-witdh","2"),x(a,"x1",c=e[13]*qt),x(a,"y1","0"),x(a,"x2",s=e[13]*qt),x(a,"y2",i=8*qt),x(a,"stroke","black"),x(a,"stroke-witdh","2")},m(t,e){u(t,n,e),u(t,a,e)},p:t,d(t){t&&f(n),t&&f(a)}}}function Tt(t){let e,n=wt,o=[];for(let e=0;e<n.length;e+=1)o[e]=Nt(kt(t,n,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=m()},m(t,n){for(let e=0;e<o.length;e+=1)o[e].m(t,n);u(t,e,n)},p(t,l){if(16&l){let r;for(n=wt,r=0;r<n.length;r+=1){const a=kt(t,n,r);o[r]?o[r].p(a,l):(o[r]=Nt(a),o[r].c(),o[r].m(e.parentNode,e))}for(;r<o.length;r+=1)o[r].d(1);o.length=n.length}},d(t){h(o,t),t&&f(e)}}}function Nt(e){let n,o=63!=e[13]&&function(e){let n,o,l,r,a;return{c(){n=g("line"),x(n,"x1",o=(Lt(e[11]).x+.5)*qt),x(n,"y1",l=(Lt(e[11]).y+.5)*qt),x(n,"x2",r=(e[4](e[13]).x+.5)*qt),x(n,"y2",a=(e[4](e[13]).y+.5)*qt),x(n,"stroke","blue"),x(n,"opacity","0.5"),x(n,"stroke-width","2")},m(t,e){u(t,n,e)},p:t,d(t){t&&f(n)}}}(e);return{c(){o&&o.c(),n=m()},m(t,e){o&&o.m(t,e),u(t,n,e)},p(t,e){63!=t[13]&&o.p(t,e)},d(t){o&&o.d(t),t&&f(n)}}}function Qt(t){let e,n,o,l,r,a,c,s=t[8]+"";return{c(){e=g("text"),n=p(s),x(e,"x",o=t[10]*qt),x(e,"y",l=t[7]*qt),x(e,"dx",r=qt/2),x(e,"dy",a=qt/2+5),x(e,"text-anchor","middle"),x(e,"fill",c=t[0]||t[8]>=70?"black":"white")},m(t,o){u(t,e,o),i(e,n)},p(t,o){8&o&&s!==(s=t[8]+"")&&y(n,s),9&o&&c!==(c=t[0]||t[8]>=70?"black":"white")&&x(e,"fill",c)},d(t){t&&f(e)}}}function At(t){let e,n=t[5],o=[];for(let e=0;e<n.length;e+=1)o[e]=Qt(Gt(t,n,e));return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=m()},m(t,n){for(let e=0;e<o.length;e+=1)o[e].m(t,n);u(t,e,n)},p(t,l){if(9&l){let r;for(n=t[5],r=0;r<n.length;r+=1){const a=Gt(t,n,r);o[r]?o[r].p(a,l):(o[r]=Qt(a),o[r].c(),o[r].m(e.parentNode,e))}for(;r<o.length;r+=1)o[r].d(1);o.length=n.length}},d(t){h(o,t),t&&f(e)}}}function Pt(e){let n,o,l,r,a,c,s,p,w,v,y,B,R,b,C,G=e[2]&&St(e),k=!e[0]&&Dt(e),M=e[3],_=[];for(let t=0;t<M.length;t+=1)_[t]=Yt(Mt(e,M,t));let z=e[1]&&Tt(e),S=e[3],D=[];for(let t=0;t<S.length;t+=1)D[t]=At(Ct(e,S,t));return{c(){n=d("div"),G&&G.c(),o=$(),l=g("svg"),r=g("g"),k&&k.c(),a=m();for(let t=0;t<_.length;t+=1)_[t].c();c=g("line"),v=g("line"),z&&z.c(),b=m();for(let t=0;t<D.length;t+=1)D[t].c();x(c,"x1","0"),x(c,"y1",s=8*qt),x(c,"x2",p=8*qt),x(c,"y2",w=8*qt),x(c,"stroke","black"),x(c,"stroke-witdh","2"),x(v,"x1",y=8*qt),x(v,"y1","0"),x(v,"x2",B=8*qt),x(v,"y2",R=8*qt),x(v,"stroke","black"),x(v,"stroke-witdh","2"),x(r,"transform","translate(10, 10)"),x(l,"width","300"),x(l,"height","300"),x(l,"viewBox",C="0 0 "+(8*qt+20)+" "+(8*qt+20))},m(t,e){u(t,n,e),G&&G.m(n,null),i(n,o),i(n,l),i(l,r),k&&k.m(r,null),i(r,a);for(let t=0;t<_.length;t+=1)_[t].m(r,null);i(r,c),i(r,v),z&&z.m(r,null),i(r,b);for(let t=0;t<D.length;t+=1)D[t].m(r,null)},p(t,[e]){if(t[2]?G?G.p(t,e):(G=St(t),G.c(),G.m(n,o)):G&&(G.d(1),G=null),t[0]?k&&(k.d(1),k=null):k?k.p(t,e):(k=Dt(t),k.c(),k.m(r,a)),8&e){let n;for(M=t[3],n=0;n<M.length;n+=1){const o=Mt(t,M,n);_[n]?_[n].p(o,e):(_[n]=Yt(o),_[n].c(),_[n].m(r,c))}for(;n<_.length;n+=1)_[n].d(1);_.length=M.length}if(t[1]?z?z.p(t,e):(z=Tt(t),z.c(),z.m(r,b)):z&&(z.d(1),z=null),9&e){let n;for(S=t[3],n=0;n<S.length;n+=1){const o=Ct(t,S,n);D[n]?D[n].p(o,e):(D[n]=At(o),D[n].c(),D[n].m(r,null))}for(;n<D.length;n+=1)D[n].d(1);D.length=S.length}},i:t,o:t,d(t){t&&f(n),G&&G.d(),k&&k.d(),h(_,t),z&&z.d(),h(D,t)}}}const qt=40;function Lt(t){return{x:t%8,y:Math.floor(t/8)}}function Ft(t,e,n){let{nocolor:o=!1}=e,{zigzag:l=!1}=e,{title:r=null}=e,{data:a=[]}=e;return t.$$set=t=>{"nocolor"in t&&n(0,o=t.nocolor),"zigzag"in t&&n(1,l=t.zigzag),"title"in t&&n(2,r=t.title),"data"in t&&n(3,a=t.data)},[o,l,r,a,function(t){const e=wt[t+1];return{x:e%8,y:Math.floor(e/8)}}]}const jt=class extends J{constructor(t){super(),Z(this,t,Ft,Pt,r,{nocolor:0,zigzag:1,title:2,data:3})}};function Ot(t){let e,n,o,l,r,a,c,s,h,g,p,m,w,v,y,B;return r=new nt({props:{title:"Y'",data:t[0],position:t[1]}}),r.$on("select",t[4]),h=new jt({props:{data:t[2],title:"Block"}}),w=new jt({props:{data:t[3],title:"DCT",nocolor:!0}}),{c(){e=d("div"),n=d("h2"),n.textContent="Block Divide & DCT",o=$(),l=d("div"),O(r.$$.fragment),a=$(),c=d("span"),c.textContent="→",s=$(),O(h.$$.fragment),g=$(),p=d("span"),p.textContent="→",m=$(),O(w.$$.fragment),v=$(),y=d("p"),y.textContent="Toggle DCT values by clicking and show corresponding pattern?",x(c,"class","arrow svelte-i8w882"),x(p,"class","arrow svelte-i8w882"),x(l,"class","container svelte-i8w882")},m(t,f){u(t,e,f),i(e,n),i(e,o),i(e,l),H(r,l,null),i(l,a),i(l,c),i(l,s),H(h,l,null),i(l,g),i(l,p),i(l,m),H(w,l,null),i(e,v),i(e,y),B=!0},p(t,[e]){const n={};1&e&&(n.data=t[0]),2&e&&(n.position=t[1]),r.$set(n);const o={};4&e&&(o.data=t[2]),h.$set(o);const l={};8&e&&(l.data=t[3]),w.$set(l)},i(t){B||(F(r.$$.fragment,t),F(h.$$.fragment,t),F(w.$$.fragment,t),B=!0)},o(t){j(r.$$.fragment,t),j(h.$$.fragment,t),j(w.$$.fragment,t),B=!1},d(t){t&&f(e),U(r),U(h),U(w)}}}function Ht(t,e,n){let o,{context:l}=e,r={x:4,y:6},a=[],c=[];function s(){l&&l.Yp&&(n(2,a=ht(l,r.x,r.y)),n(3,c=dt(a)))}return t.$$set=t=>{"context"in t&&n(5,l=t.context)},t.$$.update=()=>{32&t.$$.dirty&&function(t){if(t){n(0,o=new ImageData(t.RGB.width,t.RGB.height));for(let e=0,n=0;e<o.data.length;e+=4,n++)ct(o,e,ut(t.Yp[n],128,128));s()}}(l)},[o,r,a,c,function(t){n(1,r=t.detail),s()},l]}const Ut=class extends J{constructor(t){super(),Z(this,t,Ht,Ot,r,{context:5})}};function Zt(t){let e,n,o,l,r,a,c,s,h,g,m,y,R,b,C,G,k,M,_,z,S,D,E,I,Y,T,N,Q,A,P,q,L,Z,J,W,X,K;return r=new nt({props:{title:"Y'",data:t[1],position:t[2]}}),r.$on("select",t[9]),h=new jt({props:{data:t[3],title:"Block"}}),R=new jt({props:{data:t[4],title:"DCT",nocolor:!0}}),k=new jt({props:{data:t[8],title:"Quantization Table",nocolor:!0}}),z=new nt({props:{title:"Quantized Result",data:t[7]}}),I=new jt({props:{data:t[6],title:"Quantized Block"}}),Q=new jt({props:{data:t[5],title:"Quantized DCT",nocolor:!0}}),{c(){e=d("div"),n=d("h2"),n.textContent="Block Quantize",o=$(),l=d("div"),O(r.$$.fragment),a=$(),c=d("span"),c.textContent="→",s=$(),O(h.$$.fragment),g=$(),m=d("span"),m.textContent="→",y=$(),O(R.$$.fragment),b=$(),C=d("span"),C.textContent="⊙",G=$(),O(k.$$.fragment),M=$(),_=d("div"),O(z.$$.fragment),S=$(),D=d("span"),D.textContent="←",E=$(),O(I.$$.fragment),Y=$(),T=d("span"),T.textContent="←",N=$(),O(Q.$$.fragment),A=$(),P=d("span"),P.textContent="↵",q=$(),L=d("label"),Z=p("Quality\n        "),J=d("input"),x(c,"class","arrow svelte-i8w882"),x(m,"class","arrow svelte-i8w882"),x(C,"class","arrow svelte-i8w882"),x(l,"class","container svelte-i8w882"),x(D,"class","arrow svelte-i8w882"),x(T,"class","arrow svelte-i8w882"),x(P,"class","arrow svelte-i8w882"),x(_,"class","container svelte-i8w882"),x(J,"type","number")},m(f,d){u(f,e,d),i(e,n),i(e,o),i(e,l),H(r,l,null),i(l,a),i(l,c),i(l,s),H(h,l,null),i(l,g),i(l,m),i(l,y),H(R,l,null),i(l,b),i(l,C),i(l,G),H(k,l,null),i(e,M),i(e,_),H(z,_,null),i(_,S),i(_,D),i(_,E),H(I,_,null),i(_,Y),i(_,T),i(_,N),H(Q,_,null),i(_,A),i(_,P),i(e,q),i(e,L),i(L,Z),i(L,J),B(J,t[0]),W=!0,X||(K=w(J,"input",t[11]),X=!0)},p(t,[e]){const n={};2&e&&(n.data=t[1]),4&e&&(n.position=t[2]),r.$set(n);const o={};8&e&&(o.data=t[3]),h.$set(o);const l={};16&e&&(l.data=t[4]),R.$set(l);const a={};256&e&&(a.data=t[8]),k.$set(a);const c={};128&e&&(c.data=t[7]),z.$set(c);const s={};64&e&&(s.data=t[6]),I.$set(s);const i={};32&e&&(i.data=t[5]),Q.$set(i),1&e&&v(J.value)!==t[0]&&B(J,t[0])},i(t){W||(F(r.$$.fragment,t),F(h.$$.fragment,t),F(R.$$.fragment,t),F(k.$$.fragment,t),F(z.$$.fragment,t),F(I.$$.fragment,t),F(Q.$$.fragment,t),W=!0)},o(t){j(r.$$.fragment,t),j(h.$$.fragment,t),j(R.$$.fragment,t),j(k.$$.fragment,t),j(z.$$.fragment,t),j(I.$$.fragment,t),j(Q.$$.fragment,t),W=!1},d(t){t&&f(e),U(r),U(h),U(R),U(k),U(z),U(I),U(Q),X=!1,K()}}}function Jt(t,e,n){let o,l,r,{context:a}=e,c={x:4,y:6},s=[],i=[],u=[],f=[],h=50;function d(){a&&a.Yp&&(n(3,s=ht(a,c.x,c.y)),n(4,i=dt(s)),n(5,u=$t(i,r)),n(6,f=gt(mt(u,r))))}return t.$$set=t=>{"context"in t&&n(10,a=t.context)},t.$$.update=()=>{1025&t.$$.dirty&&function(t,e){if(e){const a=t<50?5e3/t:200-2*t;n(8,r=pt.map((t=>t.map((t=>it(Math.trunc(t*a+50)/100)))))),n(1,o=new ImageData(e.RGB.width,e.RGB.height)),n(7,l=new ImageData(e.RGB.width,e.RGB.height));for(let t=0,n=0;t<o.data.length;t+=4,n++)ct(o,t,ut(e.Yp[n],128,128));d();for(let t=0;t<Math.floor(e.RGB.height/8);++t)for(let n=0;n<Math.floor(e.RGB.width/8);++n){const o=gt(mt($t(dt(ht(e,n,t)),r),r));for(let r=0;r<8;++r)for(let a=0;a<8;++a){const c=4*((8*t+r)*e.RGB.width+(8*n+a));ct(l,c,ut(o[r][a],128,128))}}}}(h,a)},[h,o,c,s,i,u,f,l,r,function(t){n(2,c=t.detail),d()},a,function(){h=v(this.value),n(0,h)}]}const Wt=class extends J{constructor(t){super(),Z(this,t,Jt,Zt,r,{context:10})}};function Xt(t,e,n){const o=t.slice();return o[21]=e[n],o}function Kt(t,e,n){const o=t.slice();return o[21]=e[n],o}function Vt(t,e,n){const o=t.slice();return o[21]=e[n],o[27]=n,o}function te(t,e,n){const o=t.slice();return o[21]=e[n],o[27]=n,o}function ee(t,e,n){const o=t.slice();return o[21]=e[n],o[27]=n,o}function ne(t){let e,n,o=t[21]+"";return{c(){e=p(o),n=$()},m(t,o){u(t,e,o),u(t,n,o)},p(t,n){64&n&&o!==(o=t[21]+"")&&y(e,o)},d(t){t&&f(e),t&&f(n)}}}function oe(t){let e,n=t[5][t[27]]+"";return{c(){e=p(n)},m(t,n){u(t,e,n)},p(t,o){32&o&&n!==(n=t[5][t[27]]+"")&&y(e,n)},d(t){t&&f(e)}}}function le(t){let e,n,o=0!=t[27]&&function(t){let e,n,o,l=t[21].skip+"";return{c(){e=p("("),n=p(l),o=p(")")},m(t,l){u(t,e,l),u(t,n,l),u(t,o,l)},p(t,e){16&e&&l!==(l=t[21].skip+"")&&y(n,l)},d(t){t&&f(e),t&&f(n),t&&f(o)}}}(t),l=0!=t[21].size&&oe(t);return{c(){o&&o.c(),e=$(),l&&l.c(),n=$()},m(t,r){o&&o.m(t,r),u(t,e,r),l&&l.m(t,r),u(t,n,r)},p(t,e){0!=t[27]&&o.p(t,e),0!=t[21].size?l?l.p(t,e):(l=oe(t),l.c(),l.m(n.parentNode,n)):l&&(l.d(1),l=null)},d(t){o&&o.d(t),t&&f(e),l&&l.d(t),t&&f(n)}}}function re(t){let e,n=t[5][t[27]]+"";return{c(){e=p(n)},m(t,n){u(t,e,n)},p(t,o){32&o&&n!==(n=t[5][t[27]]+"")&&y(e,n)},d(t){t&&f(e)}}}function ae(t){let e,n,o,l,r=t[21].size+"",a=0!=t[27]&&function(t){let e,n,o=t[21].skip+"";return{c(){e=p(o),n=p(",")},m(t,o){u(t,e,o),u(t,n,o)},p(t,n){16&n&&o!==(o=t[21].skip+"")&&y(e,o)},d(t){t&&f(e),t&&f(n)}}}(t),c=0!=t[21].size&&re(t);return{c(){e=p("("),a&&a.c(),n=p(r),o=p(") "),c&&c.c(),l=$()},m(t,r){u(t,e,r),a&&a.m(t,r),u(t,n,r),u(t,o,r),c&&c.m(t,r),u(t,l,r)},p(t,e){0!=t[27]&&a.p(t,e),16&e&&r!==(r=t[21].size+"")&&y(n,r),0!=t[21].size?c?c.p(t,e):(c=re(t),c.c(),c.m(l.parentNode,l)):c&&(c.d(1),c=null)},d(t){t&&f(e),a&&a.d(t),t&&f(n),t&&f(o),c&&c.d(t),t&&f(l)}}}function ce(t){let e,n,o=t[21]+"";return{c(){e=p(o),n=$()},m(t,o){u(t,e,o),u(t,n,o)},p(t,n){128&n&&o!==(o=t[21]+"")&&y(e,o)},d(t){t&&f(e),t&&f(n)}}}function se(t){let e,n,o=he(t[21])+"";return{c(){e=p(o),n=$()},m(t,o){u(t,e,o),u(t,n,o)},p(t,n){256&n&&o!==(o=he(t[21])+"")&&y(e,o)},d(t){t&&f(e),t&&f(n)}}}function ie(t){let e,n,o,l,r,a,c,s,g,m,R,b,C,G,k,M,_,z,S,D,E,I,Y,T,N,Q,A,P,q,L,Z,J,W,X,K=Math.floor(6400/t[8].length)/100+"";r=new nt({props:{title:"Y'",data:t[1],position:t[2]}}),r.$on("select",t[9]),g=new jt({props:{data:t[3],title:"Quantized Block",nocolor:!0,zigzag:!0}});let V=t[6],tt=[];for(let e=0;e<V.length;e+=1)tt[e]=ne(ee(t,V,e));let et=t[4],ot=[];for(let e=0;e<et.length;e+=1)ot[e]=le(te(t,et,e));let lt=t[4],rt=[];for(let e=0;e<lt.length;e+=1)rt[e]=ae(Vt(t,lt,e));let at=t[7],ct=[];for(let e=0;e<at.length;e+=1)ct[e]=ce(Kt(t,at,e));let st=t[8],it=[];for(let e=0;e<st.length;e+=1)it[e]=se(Xt(t,st,e));return{c(){e=d("div"),n=d("h2"),n.textContent="Block Zig-Zag & Run-Length",o=$(),l=d("div"),O(r.$$.fragment),a=$(),c=d("span"),c.textContent="→",s=$(),O(g.$$.fragment),m=$(),R=d("span"),R.textContent="→",b=$(),C=d("div"),G=d("p");for(let t=0;t<tt.length;t+=1)tt[t].c();k=$(),M=d("p");for(let t=0;t<ot.length;t+=1)ot[t].c();_=$(),z=d("p");for(let t=0;t<rt.length;t+=1)rt[t].c();S=$(),D=d("p");for(let t=0;t<ct.length;t+=1)ct[t].c();E=$(),I=d("p");for(let t=0;t<it.length;t+=1)it[t].c();Y=$(),T=d("label"),N=p("Quality "),Q=d("input"),A=$(),P=d("p"),q=p("First zigzag, then run length, run-length with value size in bits, finally codes and values huffman encoded bit string and bytes.\n        (ratio for current block: 1/"),L=p(K),Z=p(")"),x(c,"class","arrow svelte-11y6gxl"),x(R,"class","arrow svelte-11y6gxl"),x(G,"class","result svelte-11y6gxl"),x(M,"class","result svelte-11y6gxl"),x(z,"class","result svelte-11y6gxl"),x(D,"class","result svelte-11y6gxl"),x(I,"class","result svelte-11y6gxl"),x(l,"class","container svelte-11y6gxl"),x(Q,"type","number")},m(f,h){u(f,e,h),i(e,n),i(e,o),i(e,l),H(r,l,null),i(l,a),i(l,c),i(l,s),H(g,l,null),i(l,m),i(l,R),i(l,b),i(l,C),i(C,G);for(let t=0;t<tt.length;t+=1)tt[t].m(G,null);i(C,k),i(C,M);for(let t=0;t<ot.length;t+=1)ot[t].m(M,null);i(C,_),i(C,z);for(let t=0;t<rt.length;t+=1)rt[t].m(z,null);i(C,S),i(C,D);for(let t=0;t<ct.length;t+=1)ct[t].m(D,null);i(C,E),i(C,I);for(let t=0;t<it.length;t+=1)it[t].m(I,null);i(e,Y),i(e,T),i(T,N),i(T,Q),B(Q,t[0]),i(e,A),i(e,P),i(P,q),i(P,L),i(P,Z),J=!0,W||(X=w(Q,"input",t[11]),W=!0)},p(t,[e]){const n={};2&e&&(n.data=t[1]),4&e&&(n.position=t[2]),r.$set(n);const o={};if(8&e&&(o.data=t[3]),g.$set(o),64&e){let n;for(V=t[6],n=0;n<V.length;n+=1){const o=ee(t,V,n);tt[n]?tt[n].p(o,e):(tt[n]=ne(o),tt[n].c(),tt[n].m(G,null))}for(;n<tt.length;n+=1)tt[n].d(1);tt.length=V.length}if(48&e){let n;for(et=t[4],n=0;n<et.length;n+=1){const o=te(t,et,n);ot[n]?ot[n].p(o,e):(ot[n]=le(o),ot[n].c(),ot[n].m(M,null))}for(;n<ot.length;n+=1)ot[n].d(1);ot.length=et.length}if(48&e){let n;for(lt=t[4],n=0;n<lt.length;n+=1){const o=Vt(t,lt,n);rt[n]?rt[n].p(o,e):(rt[n]=ae(o),rt[n].c(),rt[n].m(z,null))}for(;n<rt.length;n+=1)rt[n].d(1);rt.length=lt.length}if(128&e){let n;for(at=t[7],n=0;n<at.length;n+=1){const o=Kt(t,at,n);ct[n]?ct[n].p(o,e):(ct[n]=ce(o),ct[n].c(),ct[n].m(D,null))}for(;n<ct.length;n+=1)ct[n].d(1);ct.length=at.length}if(256&e){let n;for(st=t[8],n=0;n<st.length;n+=1){const o=Xt(t,st,n);it[n]?it[n].p(o,e):(it[n]=se(o),it[n].c(),it[n].m(I,null))}for(;n<it.length;n+=1)it[n].d(1);it.length=st.length}1&e&&v(Q.value)!==t[0]&&B(Q,t[0]),(!J||256&e)&&K!==(K=Math.floor(6400/t[8].length)/100+"")&&y(L,K)},i(t){J||(F(r.$$.fragment,t),F(g.$$.fragment,t),J=!0)},o(t){j(r.$$.fragment,t),j(g.$$.fragment,t),J=!1},d(t){t&&f(e),U(r),U(g),h(tt,t),h(ot,t),h(rt,t),h(ct,t),h(it,t),W=!1,X()}}}function ue(t){let e=[];for(let n in t)e.push({value:n,count:t[n]});for(;e.length>1;){e.sort(((t,e)=>e.count-t.count));const[t,n]=e.splice(e.length-2,2);e.push({count:t.count+n.count,left:t,right:n})}return e[0]}function fe(t){const e={};return function t(n,o,l){n.value?e[n.value]={size:o,value:l}:(t(n.left,o+1,2*l),t(n.right,o+1,2*l+1))}(t,0,0),e}function he(t){return("0"+(255&t).toString(16)).slice(-2)}function de(t,e,n){let o,l,r,a,{context:c}=e,s={x:4,y:6},i=[],u=50,f=[],h=[],d=[],g=[],p=[];function $(){if(c&&c.Yp){const t=ht(c,s.x,s.y);n(3,i=$t(dt(t),l)),n(6,d=function(t){const e=[];return wt.forEach((n=>{const o=t[Math.floor(n/8)][n%8];e.push(o)})),e}(i)),n(4,f=[]),n(5,h=[]),m(i,f,h);const e=function(t,e){let n=[],o=[],l=8,c=0;function s(t,e){const r=(1<<e)-1,a=(t<0?t+(1<<e):t)&r;let s="";for(let t=e-1;t>=0;--t)s+=a&1<<t?"1":"0";for(n.push(s);e>l;)c|=(t&r)>>e-l,o.push(c),e-=l,l=8,c=0;c|=(t&r)<<l-e,l-=e}let i=t[0].size,u=r[i];s(u.value,u.size),s(e[0],i);for(let n=1;n<t.length;++n){let o=t[n].skip;for(;o>15;){let t=a[240];s(t.value,t.size),o-=16}let l=a[o<<4|t[n].size];s(l.value,l.size),0!=e[n]&&s(e[n],t[n].size)}return l<8&&o.push(c),{bitString:n,bytes:o}}(f,h);n(7,g=e.bitString),n(8,p=e.bytes)}}function m(t,e,n){function o(t){for(let e=0;e<16;++e){const n=(1<<e)-1;if(t>=0&&(t&n)==t)return e+1;if((t&n)==t+(1<<e))return e+1}}let l=0;wt.forEach((r=>{const a=t[Math.floor(r/8)][r%8];0!=a?0==e.length?(e.push({skip:0,size:o(a)}),n.push(a)):(e.push({skip:l,size:o(a)}),n.push(a),l=0):l++})),e.push({skip:0,size:0}),n.push(0)}return t.$$set=t=>{"context"in t&&n(10,c=t.context)},t.$$.update=()=>{1025&t.$$.dirty&&function(t,e){if(e){const c=t<50?5e3/t:200-2*t;l=pt.map((t=>t.map((t=>it(Math.trunc(t*c+50)/100))))),n(1,o=new ImageData(e.RGB.width,e.RGB.height));for(let t=0,n=0;t<o.data.length;t+=4,n++)ct(o,t,ut(e.Yp[n],128,128));let s=[],i=[];for(let t=0;t<Math.floor(e.RGB.height/8);++t)for(let n=0;n<Math.floor(e.RGB.width/8);++n)m($t(dt(ht(e,n,t)),l),s,i);const u={},f={};let h=!0;s.forEach((t=>{if(h){const e=t.size,n=u[e]||0;u[e]=n+1,h=!1}else{let e=t.skip;for(;e>15;){const t=f[240]||0;f[240]=t+1,e-=16}const n=e<<4|t.size;0==n&&(h=!0);const o=f[n]||0;f[n]=o+1}})),r=fe(ue(u)),a=fe(ue(f)),$()}}(u,c)},[u,o,s,i,f,h,d,g,p,function(t){n(2,s=t.detail),$()},c,function(){u=v(this.value),n(0,u)}]}const ge=class extends J{constructor(t){super(),Z(this,t,de,ie,r,{context:10})}};function pe(t){let e,n,l,r,a,c,s,h,g;var p=t[1][t[0]];function m(t){return{props:{context:t[2]}}}return p&&(c=new p(m(t))),{c(){e=d("div"),n=d("button"),n.textContent="Previous",l=$(),r=d("button"),r.textContent="Next",a=$(),c&&O(c.$$.fragment)},m(o,f){u(o,e,f),i(e,n),i(e,l),i(e,r),i(e,a),c&&H(c,e,null),s=!0,h||(g=[w(n,"click",t[3]),w(r,"click",t[4])],h=!0)},p(t,[n]){if(p!==(p=t[1][t[0]])){if(c){q={r:0,c:[],p:q};const t=c;j(t.$$.fragment,1,0,(()=>{U(t,1)})),q.r||o(q.c),q=q.p}p?(c=new p(m(t)),O(c.$$.fragment),F(c.$$.fragment,1),H(c,e,null)):c=null}},i(t){s||(c&&F(c.$$.fragment,t),s=!0)},o(t){c&&j(c.$$.fragment,t),s=!1},d(t){t&&f(e),c&&U(c),h=!1,o(g)}}}function $e(t,e,n){const o=[at,yt,bt,Ut,Wt,ge];let l=0;return[l,o,{},function(){l>0&&n(0,l-=1)},function(){l<o.length-1&&n(0,l+=1)}]}const me=class extends J{constructor(t){super(),Z(this,t,$e,pe,r,{})}};function we(e){let n,o,l,r,a,c;return a=new me({}),{c(){n=d("main"),o=d("header"),o.innerHTML='<h1 class="svelte-etu950">JPEG Compression</h1>',l=$(),r=d("div"),O(a.$$.fragment),x(o,"class","svelte-etu950"),x(r,"class","container svelte-etu950"),x(n,"class","svelte-etu950")},m(t,e){u(t,n,e),i(n,o),i(n,l),i(n,r),H(a,r,null),c=!0},p:t,i(t){c||(F(a.$$.fragment,t),c=!0)},o(t){j(a.$$.fragment,t),c=!1},d(t){t&&f(n),U(a)}}}new class extends J{constructor(t){super(),Z(this,t,null,we,r,{})}}({target:document.body,props:{name:"world"}})})();